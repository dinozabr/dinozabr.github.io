<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Квиддич онлайн</title>
	<script src="babylon.js"></script>
	<script src="hand.js"></script>
	<link rel="stylesheet" href="style.css" >
 </head>

 <body  background='images/field1.png'>
	<div id="chat">
		<div id="message">
			<form id="messageForm">
				<p><textarea name="messageText" placeholder="Введите ваше сообщение" rows="3"></textarea></p>
				<p><button id="sendMessage"   type="submit" >Отправить</button></p>
			</form>
		</div>
	</div>
	<canvas id="renderCanvas"></canvas>
 	<div id="gameField"></div>

 </body>
 <script type="text/javascript">
  var canvas = document.getElementById("renderCanvas");
  var engine = new BABYLON.Engine(canvas, true);
  
  var createScene = function(){
 
	var scene = new BABYLON.Scene(engine);
	 var material = new BABYLON.StandardMaterial("cyl",scene);
	
	material.diffuseColor = new BABYLON.Color3.FromInts(218,165,32);
	
	var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = .7;
	<!------------------------------------------------------->
	var ground = BABYLON.Mesh.CreateGround("ground", 100, 100, 1, scene, false);
    var groundMaterial = new BABYLON.StandardMaterial("ground", scene);
	
    
	<!------------------------------------------------------->
	
	/*var camera = new BABYLON.FreeCamera("FreeCamera", new BABYLON.Vector3(0, -8, -30), scene);
	camera.speed = 3.0;
	camera.attachControl(canvas);*/ 
	
	var cylinder = BABYLON.Mesh.CreateCylinder("cylinder1", 1, 5, 5, 6, 1, scene);
	cylinder.material = material;
	var firstLine = [];
	firstLine.push(cylinder);
	for(var i = 1; i < 9; i++){
		var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
		c.material = material;
		c.position.z = firstLine[i-1].position.z + 5;
		firstLine.push(c)
	}
	var camera = new BABYLON.ArcRotateCamera("Camera", Math.PI / 2, 1.0, 110, new BABYLON.Vector3(firstLine[4].position.x,firstLine[4].position.y,firstLine[4].position.z), scene);
	camera.attachControl(canvas, true);
	var secondLine = [];
	var c = new BABYLON.Mesh.CreateCylinder("cylinder10",1,5,5,6,1,scene);
	c.position.x = cylinder.position.x + 4;
	c.position.z = cylinder.position.z + 2.5;
	c.material = material;
	secondLine.push(c);
	for(var i = 1; i < 8; i++){
	c.material = material;
		var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
		c.position.x = secondLine[i-1].position.x;
		c.material = material;
		c.position.z = secondLine[i-1].position.z + 5;
		secondLine.push(c);
	}
  
  var thirdLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder10",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 8 ;
  c.position.z = firstLine[0].position.z;
  c.material = material;
  thirdLine.push(c);
  for(var i = 1; i < 9; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = thirdLine[i-1].position.x;
	 c.material = material;
	 c.position.z = thirdLine[i-1].position.z + 5;
	thirdLine.push(c)
  }
  
  var fouthLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder11",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 12 ;
  c.position.z = secondLine[0].position.z;
  c.material = material;
  fouthLine.push(c);
  for(var i = 1; i < 8; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = fouthLine[i-1].position.x;
	 c.material = material;
	 c.position.z = fouthLine[i-1].position.z + 5;
	fouthLine.push(c)
  }
  
  var fifthLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder12",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 16 ;
  c.position.z = firstLine[0].position.z;
  c.material = material;
  fifthLine.push(c);
  for(var i = 1; i < 9; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = fifthLine[i-1].position.x;
	 c.position.z = fifthLine[i-1].position.z + 5;
	 c.material = material;
	fifthLine.push(c)
  }
  
  var sixLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 20 ;
  c.position.z = secondLine[0].position.z;
  c.material = material;
  sixLine.push(c);
  for(var i = 1; i < 8; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = sixLine[i-1].position.x;
	 c.position.z = sixLine[i-1].position.z + 5;
	 c.material = material;
	sixLine.push(c)
  }
  
   var sevenLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 24 ;
  c.position.z = firstLine[1].position.z;
  c.material = material;
  sevenLine.push(c);
  for(var i = 1; i < 7; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = sevenLine[i-1].position.x;
	 c.position.z = sevenLine[i-1].position.z + 5;
	 c.material = material;
	sevenLine.push(c)
  }
  
  var eightLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 28 ;
  c.position.z = secondLine[1].position.z;
  c.material = material;
  eightLine.push(c);
  for(var i = 1; i < 6; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = eightLine[i-1].position.x;
	 c.position.z = eightLine[i-1].position.z + 5;
	 c.material = material;
	eightLine.push(c)
  }
  var nineLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x + 32 ;
  c.position.z = sevenLine[2].position.z;
  var materialVor = new BABYLON.StandardMaterial("texture2", scene);
  materialVor.diffuseColor = new BABYLON.Color3(1, 0, 0); //Red
	c.material 	= materialVor;
  
  nineLine.push(c);
  for(var i = 1; i < 3; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = nineLine[i-1].position.x;
	 c.position.z = nineLine[i-1].position.z +  5;
	 c.material = materialVor;
	nineLine.push(c)
  }
  
  var sLine = [];
  var c = new BABYLON.Mesh.CreateCylinder("cylinder101",1,5,5,6,1,scene);
  c.position.x = cylinder.position.x - 4;
  c.position.z = cylinder.position.z + 2.5;
  c.material = material;
  sLine.push(c);
  for(var i = 1; i < 8; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = sLine[i-1].position.x;
	 c.position.z = sLine[i-1].position.z + 5;
	 c.material = material;
	 sLine.push(c);
  }
  
  var tLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder10",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 8 ;
  c.position.z = firstLine[0].position.z;
  c.material = material;
  tLine.push(c);
  for(var i = 1; i < 9; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = tLine[i-1].position.x;
	 c.material = material;
	 c.position.z = tLine[i-1].position.z + 5;
	tLine.push(c)
  }
  
  var fLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder11",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 12;
  c.material = material;
  c.position.z = secondLine[0].position.z;
  fLine.push(c);
  for(var i = 1; i < 8; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = fLine[i-1].position.x;
	 c.position.z = fLine[i-1].position.z + 5;
	 c.material = material;
	fLine.push(c)
  }
  
  var fiLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder12",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 16;
  c.material = material;
  c.position.z = firstLine[0].position.z;
  fiLine.push(c);
  for(var i = 1; i < 9; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = fiLine[i-1].position.x;
	 c.material = material;
	 c.position.z = fiLine[i-1].position.z + 5;
	fiLine.push(c)
  }
  
  var siLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 20 ;
  c.position.z = secondLine[0].position.z;
  c.material = material;
  siLine.push(c);
  for(var i = 1; i < 8; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = siLine[i-1].position.x;
	 c.position.z = siLine[i-1].position.z + 5;
	 c.material = material;
	siLine.push(c)
  }
  
   var seLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 24 ;
  c.position.z = firstLine[1].position.z;
  c.material = material;
  seLine.push(c);
  for(var i = 1; i < 7; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = seLine[i-1].position.x;
	 c.position.z = seLine[i-1].position.z + 5;
	 c.material = material;
	seLine.push(c)
  }
  
  var eiLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 28;
  c.position.z = secondLine[1].position.z;
  	c.material = material;
  eiLine.push(c);
  for(var i = 1; i < 6; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = eiLine[i-1].position.x;
	 c.position.z = eiLine[i-1].position.z + 5;
	 c.material = material;
	eiLine.push(c)
  }
  var niLine = [];
  c = new BABYLON.Mesh.CreateCylinder("cylinder13",1,5,5,6,1,scene);
  c.position.x = firstLine[0].position.x - 32;
  c.position.z = sevenLine[2].position.z;
  c.material = materialVor;
  niLine.push(c);
  for(var i = 1; i < 3; i++){
	 var c = BABYLON.Mesh.CreateCylinder("cylinder"+i, 1, 5, 5, 6, 1, scene);
	 c.position.x = niLine[i-1].position.x;
	 c.position.z = niLine[i-1].position.z + 5;
	 c.material = materialVor;
	niLine.push(c)
  }
	
	
	
	cylinder.material = material;
	
	
	var sphere = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere.material = materialVor;
	sphere.position.y +=3;
	sphere.position.z = secondLine[0].position.z;
	sphere.position.x = secondLine[0].position.x;
	
	var sphere1 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere1.material = materialVor;
	sphere1.position.y +=3;	
	sphere1.position.z = thirdLine[0].position.z;
	sphere1.position.x = thirdLine[0].position.x;
	
	var sphere2 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere2.material = materialVor;
	sphere2.position.y +=3;	
	sphere2.position.z = fouthLine[0].position.z;
	sphere2.position.x = fouthLine[0].position.x;
	
	var sphere3 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere3.material = materialVor;
	sphere3.position.y +=3;
	sphere3.position.z = fifthLine[0].position.z;
	sphere3.position.x = fifthLine[0].position.x;
	
	var sphere4 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere4.material = materialVor;
	sphere4.position.y +=3;	
	sphere4.position.z = sixLine[0].position.z;
	sphere4.position.x = sixLine[0].position.x;
	
	var sphere5 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere5.material = materialVor;
	sphere5.position.y +=3;
	sphere5.position.z = sevenLine[0].position.z;
	sphere5.position.x = sevenLine[0].position.x;
	
	var sphere6 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere6.material = materialVor;
	sphere6.position.y +=3;
	sphere6.position.z = eightLine[0].position.z;
	sphere6.position.x = eightLine[0].position.x;
	
	var materialVor1 = new BABYLON.StandardMaterial("texture2", scene);
    materialVor1.diffuseColor = new BABYLON.Color3(0, 0, 1); //Blue
  
	var sphere0 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere0.material = materialVor1;
	sphere0.position.y +=3;
	sphere0.position.z = siLine[0].position.z;
	sphere0.position.x = siLine[0].position.x;
	
	var sphere11 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere11.material = materialVor1;
	sphere11.position.y +=3;	
	sphere11.position.z = tLine[0].position.z;
	sphere11.position.x = tLine[0].position.x;

	var sphere12 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere12.material = materialVor1;
	sphere12.position.y +=3;	
	sphere12.position.z = fLine[0].position.z;
	sphere12.position.x = fLine[0].position.x;
	
	var sphere13 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere13.material = materialVor1;
	sphere13.position.y +=3;
	sphere13.position.z = fiLine[0].position.z;
	sphere13.position.x = fiLine[0].position.x;
	
	var sphere14 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere14.material = materialVor1;
	sphere14.position.y +=3;	
	sphere14.position.z = sLine[0].position.z;
	sphere14.position.x = sLine[0].position.x;
	
	var sphere15 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere15.material = materialVor1;
	sphere15.position.y +=3;
	sphere15.position.z = seLine[0].position.z;
	sphere15.position.x = seLine[0].position.x;
	
	var sphere16 = BABYLON.Mesh.CreateSphere("sphere", 3.0, 3.0, scene, false,  BABYLON.Mesh.DEFAULTSIDE);
	sphere16.material = materialVor1;
	sphere16.position.y +=3;
	sphere16.position.z = eiLine[0].position.z;
	sphere16.position.x = eiLine[0].position.x;
	
	 var startingPoint;
    var currentMesh;

    var getGroundPosition = function () {
        // Use a predicate to get position on the ground
        var pickinfo = scene.pick(scene.pointerX, scene.pointerY, function (mesh) { return mesh == ground ; });
        if (pickinfo.hit) {
            return pickinfo.pickedPoint;
        }

        return null;
    }

    var onPointerDown = function (evt) {
        if (evt.button !== 0) {
            return;
        }

        // check if we are under a mesh
        var pickInfo = scene.pick(scene.pointerX, scene.pointerY, function (mesh) { return mesh !== ground && (mesh == sphere || mesh == sphere1 || mesh == sphere2 || mesh == sphere3 || mesh == sphere4 || mesh == sphere5 || mesh == sphere6 || mesh == sphere0 || mesh == sphere11 || mesh == sphere12 || mesh == sphere13 || mesh == sphere14 || mesh == sphere15 || mesh == sphere16); });
        if (pickInfo.hit) {
            currentMesh = pickInfo.pickedMesh;
            startingPoint = getGroundPosition(evt);

            if (startingPoint) { // we need to disconnect camera from canvas
                setTimeout(function () {
                    camera.detachControl(canvas);
                }, 0);
            }
        }
    }

    var onPointerUp = function () {
        if (startingPoint) {
            camera.attachControl(canvas, true);
            startingPoint = null;
            return;
        }
    }

    var onPointerMove = function (evt) {
        if (!startingPoint) {
            return;
        }

        var current = getGroundPosition(evt);

        if (!current) {
            return;
        }

        var diff = current.subtract(startingPoint);
        currentMesh.position.addInPlace(diff);

        startingPoint = current;

    }

    canvas.addEventListener("pointerdown", onPointerDown, false);
    canvas.addEventListener("pointerup", onPointerUp, false);
    canvas.addEventListener("pointermove", onPointerMove, false);

    scene.onDispose = function () {
        canvas.removeEventListener("pointerdown", onPointerDown);
        canvas.removeEventListener("pointerup", onPointerUp);
        canvas.removeEventListener("pointermove", onPointerMove);
    }
	
	scene.clearColor = new BABYLON.Color4(0,0,0,0);
	ground.clearColor = new BABYLON.Color4(1,0,0,0);
	scene.collisionsEnabled = true;
	camera.checkCollisions = true;
	ground.checkCollisions = true;
	sphere.checkCollisions = true;
		
		return scene;
  }
  
  
  var scene = createScene();
 
  
  
  
  
  scene.activeCamera.attachControl(canvas);
	
	
	
  engine.runRenderLoop(function () {
    scene.render();	
  });
  
 
</script>
</html>